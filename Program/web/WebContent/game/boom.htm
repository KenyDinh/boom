#if (${user})
<style>
nav#main-nav-bar{
	display:none;
}
html{
	overflow-y:hidden;
}
</style>
<div style="position:relative">
	<div id="game-control">
		<div style="padding:3rem;">
			#if (${inspector})
			<div class="col-3">
				#if (${stage_list})
				<select name="stage" id="stage" class="custom-select">
				#foreach (${stage} in ${stage_list})
					<option value="${stage.getId()}">${stage.getName()}</option>
				#end
				</select>
				#end
				<div class="custom-control custom-checkbox" style="margin:1rem 0;">
					<input type="checkbox" class="custom-control-input" id="inspector-mode"/>
					<label class="custom-control-label none-select" for="inspector-mode">Inspector Mode</label>
				</div>
				<button class="btn btn-info" id="create-game">Create Game</button>
			</div>
			#else
				#if (!${stage_list})
				<button class="btn btn-info" id="create-game">Create Game</button>
				#end
			#end
		</div>
		<div id="room-list">
			#if (${list})
			<h3 class="text-center">Available rooms</h3>
			<div style="display:flex;justify-content:center;">
				#foreach (${game} in ${list})
				<div class="game-room border" data-id="${game.getGameId()}" title="Join this room">
					<img src="${context}/img/game/boom/${game.getMapImage()}"/>
					<div class="font-weight-bold bg-success text-center" data-toggle="tooltip" data-placement="bottom" title="Boom room">${game.getHostName()}</div>
				</div>
				#end
			</div>
			#end
		</div>
	</div>
	<div id="game-board">
		<div id="left-panel">
			<div style="display:flex;flex-direction:column;">
			<div id="score-panel">
				<div style="margin-top:1rem;">
					<h5>Player Score:</h5>
					<div id="player-score">
					</div>
				</div>
				<div class="force-exit-game" style="margin-top:3rem;text-align:center;display:none;"><button class="btn btn-danger">Force Finish</button></div>
			</div>
			<div id="map-list" style="display:none;">
			<h5 class="text-center">Available maps</h5>
			<div style="display:flex;max-width:240px;flex-wrap: wrap;">
			#foreach (${map} in ${maps})
				<div class="game-map" data-id="${map.getId()}" title="Choose this map">
				<img src="${context}/img/game/boom/${map.getImage()}"/>
				</div>
			#end
			</div>
			</div>
			#if (!${stage_list})
				<div id="game-mode" style="display:none;">
				<h5>Choose game mode:</h5>
				<div class="form-check">
					<input class="form-check-input game-mode-select" id="game_mode_sigle" type="radio" name="game_mode" value="0">
					<label class="form-check-label font-weight-bold text-warning" for="game_mode_sigle">Single</label>
				</div>
				<div class="form-check">
					<input class="form-check-input game-mode-select" id="game_mode_party" type="radio" name="game_mode" value="1">
					<label class="form-check-label font-weight-bold text-warning" for="game_mode_party" title="randomly grouping at least 4 players">Party</label>
				</div>
				</div>
			#end
			<div id="character-class">
			<h5>Character classes:</h5>
			#foreach (${type} in ${char_types})
				<div class="form-check">
					<input class="form-check-input char-class-select" type="radio" id="char_class_${type.ordinal()}" name="char_class" value="${type.ordinal()}">
					<label class="form-check-label font-weight-bold text-info" for="char_class_${type.ordinal()}">${type.name()}</label>
				</div>
			#end
			</div>
			<div id="character-info">
			<h5>Character base stats:</h5>
			#foreach ($char in ${characters})
				<p class="char-info-detail" data-id="${char.getId()}" style="display:none;">
					Max HP: ${char.getMaxHP()}<br/>
					Base movement speed: ${char.getMovementSpeed()}<br/>
					Max movement speed: ${char.getMaxMovementSpeed()}<br/>
					Base damage: ${char.getDamage()}<br/>
					Max damage: ${char.getMaxDamage()}<br/>
					#if (${char.getType()} == 0)
						Base bomb capacity: ${char.getFormatStat(${char.getAttackSpeed()})}<br/>
						Max bomb capacity: ${char.getFormatStat(${char.getMaxAttackSpeed()})}<br/>
						Base bomb explosion range: ${char.getFormatStat(${char.getAttackRange()})}<br/>
						Max bomb explosion range: ${char.getFormatStat(${char.getMaxAttakRange()})}<br/>
					#else
						Base attack speed: ${char.getFormatStat(${char.getAttackSpeed()})}<br/>
						Max attack speed: ${char.getFormatStat(${char.getMaxAttackSpeed()})}<br/>
						Base attack range: ${char.getFormatStat(${char.getAttackRange()})}<br/>
						Max attack range: ${char.getFormatStat(${char.getMaxAttakRange()})}<br/>
					#end
				</p>
			#end
			</div>
			<div id="hot-key-info">
			<h5>Hotkey cheat sheet:</h5>
				<p>
					Move right: &#129042;, D<br/>
					Move left: &#129040;, A<br/>
					Move up: &#129041;, W<br/>
					Move down: &#129043;, S<br/>
					Plant bomb/Attack: Space<br/>
				</p>
			</div>
			</div>
		</div>
		<div class="exit-game" style="position:absolute;top:-3rem;display:none;"><button class="btn btn-danger" >Exit Game</button></div>
		<div id="character-list" style="max-width:864px;overflow-x:auto;display:none;cursor:grab;">
			#foreach($char in ${characters})
				#if ( ${char.getId()} gt 0 )
					<div class="character" data-id="${char.getId()}" data-type="${char.getType()}" style="background-image:url('${context}/img/game/boom/char/${char.getImage()}');"></div>
				#end
			#end
		</div>
		<canvas id="canvas"></canvas>
		<div id="item-list" class="none-select" style="position:absolute;right:0;top:0;display:none;">
			<h5 class="text-center">Available items</h5>
			<div id="scroll-items" style="display:flex;flex-direction:column;overflow-y:scroll;max-height:672px;cursor:grab;">
			#if (${itm_cnt})
				#foreach (${item} in ${items})
					#set ($posx = (${item.getImageID()} % ${itm_cnt}) * 32)
					#set ($posy = (${item.getImageID()} / ${itm_cnt}) * 32)
					<div class="game-item border" data-id="${item.getId()}" style="width:250px;text-align:center;color:#00bc8c;display:flex;">
						<div style="background-image:url('${context}/img/game/boom/map/item_update.png');background-position: -${posx}px -${posy}px;width:32px;height:32px;flex-shrink:0;"></div>
						<div style="font-size: 13px;">${format.message(${messages.get(${item.getLableExplain()})},${item.getItemEffectParam(1)},${item.getItemEffectDuration(1)})}</div>
					</div>
				#end
			#else
				<label>Missing item count</label>
			#end
			</div>
		</div>
	</div>
</div>
<span class="d-none" id="token">${token}</span>
<div class="d-none" id="sound-effect">
	<audio id="se-explosion">
		<source src="${context}/img/game/boom/sound/explosion.mp3" type="audio/mpeg"/>
	</audio>
	#if (${sound_tracks})
	#foreach (${track} in ${sound_tracks})
		<audio class="se-track" data-id="${track.getId()}">
			<source src="${context}/img/game/boom/sound/${track.getFileName()}" type="audio/mpeg"/>
		</audio>
	#end
	#end
</div>
<script type="text/javascript">
//<![CDATA[
#if(${js_variable})
	${js_variable}
#end
//]]>
</script>
#end
